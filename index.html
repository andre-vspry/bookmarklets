<html>
<head>
<title>Pasword Bookmarklets</title>
</head>
<body>
<p><a href="javascript:(function(){
'use strict';

var cryptoObject = null;
var CHARACTER_SETS = {
  'Numbers': '0123456789',
  'Lowercase': 'abcdefghijklmnopqrstuvwxyz',
  'Uppercase': 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
  'Symbols': '!#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~'+String.fromCharCode(34),
  'SaferSymbols': '+-./:',
  'Space': ' '
};

function shuffle(s) {
  var array = s.split('');
  var l = array.length;
  var temp, r;
  while (0 !== l) {
    r = randomInt(l);
    l -= 1;
    temp = array[l];
    array[l] = array[r];
    array[r] = temp;
  }
  return array.join('');
}

function generatePassword(charset, len) {
  var result = '';
  for (var i = 0; i < len; i++) {
    result += charset[randomInt(charset.length)];
  }
  return result;
}

function randomInt(n) {
  var x = randomIntMathRandom(n);
  x = (x + randomIntBrowserCrypto(n)) % n;
  return x;
}

function randomIntMathRandom(n) {
  var x = Math.floor(Math.random() * n);
  if (x < 0 || x >= n) throw 'Arithmetic exception';
  return x;
}

function randomIntBrowserCrypto(n) {
  if (cryptoObject == null) return 0;
  var x = new Uint32Array(1);
  do {
    cryptoObject.getRandomValues(x);
  } while (x[0] - x[0] % n > 4294967296 - n);
  return x[0] % n;
}

function initCrypto() {
  if ('crypto' in window) cryptoObject = crypto;else if ('msCrypto' in window) cryptoObject = msCrypto;else return;
}

function executeCopy(text) {
  var input = document.createElement('textarea');
  document.body.appendChild(input);
  input.value = text;
  input.focus();
  input.select();
  document.execCommand('Copy');
  input.remove();
};

function doPassword() {
  var length = 24;
  var minNumbers = 1;
  var minLowercase = 1;
  var minUppercase = 1;
  var minSaferSymbols = 1;
  var mandatory = minNumbers + minLowercase + minUppercase + minSaferSymbols;
  var allowedCharset = CHARACTER_SETS['Numbers'] + CHARACTER_SETS['Lowercase'] + CHARACTER_SETS['Uppercase'] + CHARACTER_SETS['SaferSymbols'];
  var password = generatePassword(allowedCharset, length - mandatory) + generatePassword(CHARACTER_SETS['Numbers'], minNumbers) + generatePassword(CHARACTER_SETS['Lowercase'], minLowercase) + generatePassword(CHARACTER_SETS['Uppercase'], minUppercase) + generatePassword(CHARACTER_SETS['SaferSymbols'], minSaferSymbols);
  return password;
}

function doPasswordWithoutSpecials() {
  var length = 24;
  var minNumbers = 1;
  var minLowercase = 1;
  var minUppercase = 1;
  var mandatory = minNumbers + minLowercase + minUppercase;
  var allowedCharset = CHARACTER_SETS['Numbers'] + CHARACTER_SETS['Lowercase'] + CHARACTER_SETS['Uppercase'];
  var password = generatePassword(allowedCharset, length - mandatory) + generatePassword(CHARACTER_SETS['Numbers'], minNumbers) + generatePassword(CHARACTER_SETS['Lowercase'], minLowercase) + generatePassword(CHARACTER_SETS['Uppercase'], minUppercase);
  return password;
}

initCrypto();
var password = shuffle(doPasswordWithoutSpecials());
executeCopy(password);
})()
">Password</a></p>
<p><a href="javascript:(function(){
'use strict';

var cryptoObject = null;
var CHARACTER_SETS = {
  'Numbers': '0123456789',
  'Lowercase': 'abcdefghijklmnopqrstuvwxyz',
  'Uppercase': 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
  'Symbols': '!#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~'+String.fromCharCode(34),
  'SaferSymbols': '+-./:',
  'Space': ' '
};

function shuffle(s) {
  var array = s.split('');
  var l = array.length;
  var temp, r;
  while (0 !== l) {
    r = randomInt(l);
    l -= 1;
    temp = array[l];
    array[l] = array[r];
    array[r] = temp;
  }
  return array.join('');
}

function generatePassword(charset, len) {
  var result = '';
  for (var i = 0; i < len; i++) {
    result += charset[randomInt(charset.length)];
  }
  return result;
}

function randomInt(n) {
  var x = randomIntMathRandom(n);
  x = (x + randomIntBrowserCrypto(n)) % n;
  return x;
}

function randomIntMathRandom(n) {
  var x = Math.floor(Math.random() * n);
  if (x < 0 || x >= n) throw 'Arithmetic exception';
  return x;
}

function randomIntBrowserCrypto(n) {
  if (cryptoObject == null) return 0;
  var x = new Uint32Array(1);
  do {
    cryptoObject.getRandomValues(x);
  } while (x[0] - x[0] % n > 4294967296 - n);
  return x[0] % n;
}

function initCrypto() {
  if ('crypto' in window) cryptoObject = crypto;else if ('msCrypto' in window) cryptoObject = msCrypto;else return;
}

function executeCopy(text) {
  var input = document.createElement('textarea');
  document.body.appendChild(input);
  input.value = text;
  input.focus();
  input.select();
  document.execCommand('Copy');
  input.remove();
};

function doPassword() {
  var length = 24;
  var minNumbers = 1;
  var minLowercase = 1;
  var minUppercase = 1;
  var minSaferSymbols = 1;
  var mandatory = minNumbers + minLowercase + minUppercase + minSaferSymbols;
  var allowedCharset = CHARACTER_SETS['Numbers'] + CHARACTER_SETS['Lowercase'] + CHARACTER_SETS['Uppercase'] + CHARACTER_SETS['SaferSymbols'];
  var password = generatePassword(allowedCharset, length - mandatory) + generatePassword(CHARACTER_SETS['Numbers'], minNumbers) + generatePassword(CHARACTER_SETS['Lowercase'], minLowercase) + generatePassword(CHARACTER_SETS['Uppercase'], minUppercase) + generatePassword(CHARACTER_SETS['SaferSymbols'], minSaferSymbols);
  return password;
}

function doPasswordWithoutSpecials() {
  var length = 24;
  var minNumbers = 1;
  var minLowercase = 1;
  var minUppercase = 1;
  var mandatory = minNumbers + minLowercase + minUppercase;
  var allowedCharset = CHARACTER_SETS['Numbers'] + CHARACTER_SETS['Lowercase'] + CHARACTER_SETS['Uppercase'];
  var password = generatePassword(allowedCharset, length - mandatory) + generatePassword(CHARACTER_SETS['Numbers'], minNumbers) + generatePassword(CHARACTER_SETS['Lowercase'], minLowercase) + generatePassword(CHARACTER_SETS['Uppercase'], minUppercase);
  return password;
}

initCrypto();
var password = shuffle(doPassword());
executeCopy(password);
})()
">Stronger Password</a></p>
</body>
